<nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <%= link_to "ReferMe", jobs_path, class: "navbar-brand", id: "find-all-jobs" %>
    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
              <% if current_company %>
              <li><%= link_to "My jobs", jobs_path %> </li>
              <li><%= link_to 'New Job', new_job_path %></li>
              <li><%= link_to "Sign out", destroy_company_session_path, :method => :delete %> </li>
              <% end %>
              <% if current_user %>
              <li> <%= link_to "Sign out User", destroy_user_session_path, :method => :delete %> </li>
              <li><a href="#">My Referral Code: <%= current_user.ref_code %></a></li>
              <% end %>
        </ul>
        <div class="col-sm-3 col-md-3 pull-right">
        </div>
    </div>
</nav>
<% if current_company %>
      <% if @my_jobs.empty? == false %>
      my jobs <br>
        <% @my_jobs.each do |job| %>
          <% if job.position_filled == false %>
            <%= job.position %>
            <%= link_to "mark job as hired", edit_job_path(job.id) %> <br>
        <% end %>
      <% end %>
      <% else %>
        you have no jobs, post a new job
      <% end %>
<% end %>


<% if current_user %>
<p id="search"><%= form_tag jobs_path, :method => 'get', class: "navbar-form index-search" do %>
  <div class="input-group">
      <%= text_field_tag :city, params[:city], class: "form-control", placeholder: " Search by City: New York" %>
        <div class="input-group-btn">
            <%= submit_tag "Search", :name => nil, class: "btn btn-default",  id: "search-btn"%>
          </div>
  </div>
</p>
<% end %>

<div id="filtered">
    Filtered jobs
    <% @filtered_jobs.each do |job| %>
    <%= job.position %>
    <%= job.city %>
    <br>
  <% end %>
</div>

<div id="all-jobs">
All jobs
<br>
<% @jobs.each_with_index do |job, index| %>
  <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapse<%= index.to_s %>">
        <%= job.position %>
        <%= job.company.name %>
        <%= job.position_filled %>
  </a>
  <div id="collapse<%= index.to_s %>" class="accordion-body collapse in">
    # of applications <%= job.applications.count %>
    application link: <a href="applications/new?job_id=<%=job.id%>">http://localhost:3000/applications/new?job_id<%=job.id%></a>
  </div>
  <br>
<% end %>

</div>

<% end %>


<script>

$(document).ready(function() {

  $(".accordion-body").toggle();
  $(".accordion-toggle").click(function(){
    var href = $(".accordion-toggle").attr('href');
    console.log(href);
    var res = href.split("");
    var last = res[res.length - 1];
    console.log("#collapse" + last);
    $("#collapse" + last.to_s).toggle();
  });

$("#filtered").hide();
$( "#search-btn" ).click(function(event) {
  $("#filtered").show();
  $("#all-jobs").hide();
  event.preventDefault();
});


$( "#find-all-jobs" ).click(function(event) {
  $("#filtered").hide();
  $("#all-jobs").show();
  event.preventDefault();
});



});


</script>